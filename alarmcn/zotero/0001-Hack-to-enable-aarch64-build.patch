From aa708d5bffd03f4bdbe30c7556f62eb894e85c16 Mon Sep 17 00:00:00 2001
From: Yichao Yu <yyc1992@gmail.com>
Date: Thu, 16 Jan 2025 19:42:04 -0500
Subject: [PATCH] Hack to enable aarch64 build

---
 app/assets/application.ini  | 2 +-
 app/build.sh                | 4 ++--
 app/scripts/fetch_xulrunner | 4 ++--
 3 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/app/assets/application.ini b/app/assets/application.ini
index 83e22d9d4..d347abb69 100644
--- a/app/assets/application.ini
+++ b/app/assets/application.ini
@@ -7,7 +7,7 @@ Copyright=Copyright (c) 2006-2022 Contributors
 ID=zotero@zotero.org
 
 [Gecko]
-MinVersion=128.0
+MinVersion=128.0a0
 MaxVersion=128.99.*
 
 [XRE]
diff --git a/app/build.sh b/app/build.sh
index 0659aa62a..086d30134 100755
--- a/app/build.sh
+++ b/app/build.sh
@@ -863,9 +863,9 @@ fi
 if [ $BUILD_LINUX == 1 ]; then
 	# Skip 32-bit build in tests
 	if [[ "${ZOTERO_TEST:-}" = "1" ]] || [[ "${SKIP_32:-}" = "1" ]]; then
-		archs="x86_64"
+		archs="x86_64 aarch64"
 	else
-		archs="i686 x86_64"
+		archs="i686 x86_64 aarch64"
 	fi
 	
 	for arch in $archs; do
diff --git a/app/scripts/fetch_xulrunner b/app/scripts/fetch_xulrunner
index cbebf96e8..b29ae3a66 100755
--- a/app/scripts/fetch_xulrunner
+++ b/app/scripts/fetch_xulrunner
@@ -561,9 +561,9 @@ if [ $BUILD_LINUX == 1 ]; then
 
 	# Include 32-bit build if not in CI
 	if [[ "${CI:-}" = "1" ]] || [[ "${SKIP_32:-}" = "1" ]]; then
-		arches="x86_64"
+		arches="x86_64 aarch64"
 	else
-		arches="i686 x86_64"
+		arches="i686 x86_64 aarch64"
 	fi
 	for arch in $arches; do
 		xdir="firefox-$arch"
-- 
2.47.1

